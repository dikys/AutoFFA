# Auto FFA

**Auto FFA** — это игровой режим для Horde: The Northern Wind, где каждый сам за себя, но с уникальной механикой вассалитета и альянсов, формирующихся прямо в бою. Уничтожьте вражеский замок, чтобы сделать его владельца своим вассалом и повести свою растущую империю к победе!

## Геймплей

### Основные правила

1.  **Все против всех (Free For All)**: В начале игры все игроки находятся в состоянии войны друг с другом.
2.  **Захват вассалов**: Уничтожив замок другого игрока, вы не выбиваете его из игры. Вместо этого он и вся его команда (включая его собственных вассалов) становятся вассалами вашей команды.
3.  **Победа**: Игра заканчивается, когда на карте остается только одна команда.

### Команды и Лидерство

*   **Динамичные команды**: Команды (альянсы) формируются путем завоевания. Победитель поглощает команду побежденного.
*   **Сюзерен и Вассалы**: Глава команды называется **Сюзереном**. Все остальные участники — **Вассалами**.
*   **Смена лидера**: Сюзереном в команде автоматически становится самый влиятельный игрок, набравший больше всего **Очков Влияния**. Если вассал становится влиятельнее своего сюзерена, он занимает его место.

### Очки Влияния (Power Points)

**Очки Влияния** — это ключевой показатель вашей мощи и успешности в игре.

*   **Как заработать**: Вы получаете очки влияния, нанося урон вражеским юнитам. Чем дальше от своего замка вы сражаетесь, тем больше очков получаете.
*   **На что влияют**:
    *   **Лидерство в команде**: Игрок с наибольшим количеством очков становится Сюзереном.
    *   **Дополнительный доход**: Периодически вы получаете ресурсы в зависимости от накопленных очков влияния.
    *   **Лимиты для вассалов**: Очки влияния незначительно увеличивают лимиты по населению и ресурсам для вассалов.

### Механика «Цель»

Каждому игроку (или команде) назначается случайная вражеская команда в качестве **Цели**. Имя цели отображается рядом с вашим замком. Атака на назначенную цель приносит **удвоенные Очки Влияния**, что делает охоту на конкретного противника стратегически выгодной. Если ваша цель становится вашим союзником (например, после захвата), вам автоматически назначается новая цель.

### Итоги битвы

Чтобы помочь игрокам отслеживать свою эффективность, после каждого боя выводится сводка. Если вы перестали получать Очки Влияния в течение минуты, вам придет сообщение, показывающее, сколько очков вы заработали в последней стычке. Эта механика включается и настраивается в `AutoFFASettings.ts`.

### Экономика

*   **Дань с вассалов**: Вассалы платят дань своему Сюзерену, отдавая излишки ресурсов и свободных крестьян.
*   **Щедрость Сюзерена**: Если казна Сюзерена переполнена, он делится ресурсами со своими вассалами, чтобы усилить команду.

### Дипломатия

*   **Временное перемирие**: После захвата новой команды, ваша команда получает временное перемирие со всеми остальными игроками, чтобы дать вам время на восстановление и организацию.
*   **Коалиции против лидера**: Когда перемирие заканчивается, дипломатия возвращается в состояние войны. Однако, если одна из команд становится слишком доминирующей, остальные могут заключить мир между собой, чтобы вместе противостоять общей угрозе.

---

## Установка и сборка мода

Все данные мода находятся в директории `ModData`: конфиги, изображения, звуки, скрипты.

Для запаковки релизной версии мода следует использовать скрипт `pack-release.bat`.
Скрипт запускается двойным нажатием левой кнопки мыши. Релизный архив будет находиться в директории `Build`.

---

### Настройка игры

Хост может легко изменять правила игры, редактируя значения в файле `ModData/Scripts/AutoFFASettings.ts` перед запуском карты.

**Основные параметры для настройки:**
*   `initialPowerPoints`: Начальные очки влияния.
*   `temporaryPeaceDurationTicks`: Длительность мирного договора.
*   `vassalResourceLimit`: Лимит ресурсов для вассалов.
*   `suzerainGenerosityThreshold`: Порог богатства для сюзерена.
*   `enableTargetSystem`: Включает/отключает механику "Цель".
*   `targetPowerPointsMultiplier`: Множитель очков влияния за атаку цели.
*   `enableBattleSummaryMessages`: Включает/отключает сообщения с итогами битвы.
*   `battleSummaryTimeoutTicks`: Время бездействия (в тиках), после которого битва считается завершенной.
*   `enableCoalitionsAgainstLeader`: Включает/отключает механику объединения всех против самой сильной команды.
*   И другие... (полный список с комментариями см. в файле).

### История изменений

**20250805**
*   Имя участника теперь формируется из никнеймов всех игроков, управляющих одним поселением (например, "Игрок1 & Игрок2").

**20250804**
*   Добавлена механика "Итоги битвы": после периода бездействия в бою игрок получает сообщение о количестве заработанных очков силы.

**20250803**
*   Добавлена механика "Цель": каждому игроку назначается случайный враг, атака которого приносит удвоенные очки влияния.
*   Добавлены уведомления для игроков о назначении и смене цели.

**20250802**
*   переработал геймплей, теперь изначально все враги, теперь все бои идут твоя команда против всех
*   первые 5 минут игровые мирные
*   если на карте появилась команда с > 50% участников, то все объединяются против неё
*   после победы над противником, команда победителя становится нейтральной на 1 минут
*   каждую 1 минуту активируется охота за игрока с минимальными очками силы (он приносит в 2 раза больше очков)
*   изменил начисление очков от расстояния

**20241129**
*   начальное число очков власти 0 -> 1500
*   в 2 раза уменьшил набор очков за урон
*   теперь урон не наносится только нейтралам (ранее союзникам тоже)
*   добавлено сообщение сколько начислено очков власти за победу
*   изменено сообщение об объявлении войны между сюзеренами
*   добавлена подпись сюзерен и вассал

**20241121**
*   теперь дерева 5% -> 10% от очков власти начисляют
*   начальное число очков власти = 0
*   в 4 раза увеличил набор очков за урон

**20241118**
*   теперь дерева 5% от очков власти начисляют
*   изменил цвет текста очков власти, теперь ближе к цвету игрока
*   теперь мирным целям нельзя нанести существенный урон

**20241116**
*   Убрал надпись у проигравшего вассала "Ваш вассал перешел *****"
*   Добавил очки власти за нанесение урона
*   Переработал начисление очков власти при поражении/победе, теперь 20/10% очков проигравшего сюзерена/вассала разделяются среди команды относительно нанесенного урона
*   Теперь если тебя взяли под крыло по терпимости, то тоже 20/10% очков забирают у сюзерена/вассала по равну среди команды

**20241109**
*   Первый таймер терпимости теперь с объявления войны, а не с начала игры
*   Добавил запрет на самоуничтожение главного замка
*   Добавил очки власти (пока считаются просто за победу/поражение). Если проиграл вассал, то сюзеренам +300 и -500, вассалам +250, -300. Если проиграл сюзерен, то сюзеренам +1000 и -1000, вассалам +500 и -500.
*   Также добавил автоматическую сменю сюзерена на того у кого больше всего очков власти.